<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CrewAI Dashboard</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide-react@0.263.1/dist/umd/lucide-react.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { 
            Users, CheckSquare, Play, FileText, Plus, Download, Settings, ChevronDown, 
            User, Target, Briefcase, Upload, Save, FolderOpen, Trash2, Edit3, Copy,
            BarChart3, Clock, Zap, Brain, Network, Eye, Pause, RotateCcw, 
            MessageSquare, Star, Filter, Search, Calendar, TrendingUp, Activity,
            Database, Code, Globe, Shield, Cpu, Layers, Monitor
        } = LucideReact;

        const CrewAIDashboard = () => {
            const [activeTab, setActiveTab] = useState('agents');
            const [agents, setAgents] = useState([]);
            const [tasks, setTasks] = useState([]);
            const [executionConfig, setExecutionConfig] = useState({
                topic: '',
                model: 'llama-3.3-70b',
                process: 'sequential',
                maxIterations: 10,
                verbose: true,
                memory: true,
                collaboration: true
            });
            const [isExecuting, setIsExecuting] = useState(false);
            const [executionOutput, setExecutionOutput] = useState('');
            const [executionLogs, setExecutionLogs] = useState([]);
            const [wsConnection, setWsConnection] = useState(null);

            const [agentForm, setAgentForm] = useState({
                role: '',
                goal: '',
                backstory: '',
                tools: [],
                maxIterations: 5,
                temperature: 0.7,
                model: 'llama-3.3-70b'
            });

            const [taskForm, setTaskForm] = useState({
                name: '',
                description: '',
                expectedOutput: '',
                assignedAgent: '',
                priority: 'medium',
                context: '',
                outputFormat: 'text'
            });

            const addAgent = () => {
                if (agentForm.role && agentForm.goal && agentForm.backstory) {
                    const newAgent = {
                        id: Date.now(),
                        ...agentForm,
                        tools: agentForm.tools || []
                    };
                    setAgents([...agents, newAgent]);
                    setAgentForm({
                        role: '',
                        goal: '',
                        backstory: '',
                        tools: [],
                        maxIterations: 5,
                        temperature: 0.7,
                        model: 'llama-3.3-70b'
                    });
                }
            };

            const addTask = () => {
                if (taskForm.name && taskForm.description && taskForm.expectedOutput) {
                    const newTask = {
                        id: Date.now(),
                        ...taskForm
                    };
                    setTasks([...tasks, newTask]);
                    setTaskForm({
                        name: '',
                        description: '',
                        expectedOutput: '',
                        assignedAgent: '',
                        priority: 'medium',
                        context: '',
                        outputFormat: 'text'
                    });
                }
            };

            const executeCrewAPI = async () => {
                if (agents.length === 0 || tasks.length === 0 || !executionConfig.topic) {
                    alert('Please add at least one agent, one task, and specify a topic');
                    return;
                }

                try {
                    const response = await fetch('http://localhost:8000/api/v1/execute-crew', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            agents: agents,
                            tasks: tasks,
                            config: executionConfig,
                            topic: executionConfig.topic
                        }),
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();
                    console.log('Execution started:', result);
                } catch (error) {
                    console.error('Error executing crew:', error);
                    alert('Error starting execution. Make sure the backend server is running on port 8001.');
                }
            };

            return React.createElement('div', { className: 'min-h-screen bg-gray-50' },
                // Header
                React.createElement('header', { className: 'bg-white shadow-sm border-b' },
                    React.createElement('div', { className: 'max-w-7xl mx-auto px-4 sm:px-6 lg:px-8' },
                        React.createElement('div', { className: 'flex justify-between items-center h-16' },
                            React.createElement('div', { className: 'flex items-center' },
                                React.createElement(Brain, { className: 'w-8 h-8 text-blue-600 mr-3' }),
                                React.createElement('h1', { className: 'text-xl font-bold text-gray-900' }, 'CrewAI Dashboard')
                            ),
                            React.createElement('div', { className: 'flex items-center space-x-4' },
                                React.createElement('div', { className: 'flex items-center px-3 py-1 rounded-full text-sm bg-green-100 text-green-800' },
                                    React.createElement('div', { className: 'w-2 h-2 rounded-full mr-2 bg-green-500' }),
                                    'Ready'
                                )
                            )
                        )
                    )
                ),
                
                // Navigation
                React.createElement('nav', { className: 'bg-white shadow-sm' },
                    React.createElement('div', { className: 'max-w-7xl mx-auto px-4 sm:px-6 lg:px-8' },
                        React.createElement('div', { className: 'flex space-x-8' },
                            [
                                { id: 'agents', label: 'Agents', icon: Users },
                                { id: 'tasks', label: 'Tasks', icon: CheckSquare },
                                { id: 'execute', label: 'Execute', icon: Play },
                                { id: 'files', label: 'Files', icon: FileText }
                            ].map(tab => {
                                const Icon = tab.icon;
                                return React.createElement('button', {
                                    key: tab.id,
                                    onClick: () => setActiveTab(tab.id),
                                    className: `flex items-center px-3 py-4 text-sm font-medium border-b-2 transition-colors ${
                                        activeTab === tab.id
                                            ? 'border-blue-500 text-blue-600'
                                            : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                                    }`
                                },
                                    React.createElement(Icon, { className: 'w-4 h-4 mr-2' }),
                                    tab.label
                                );
                            })
                        )
                    )
                ),

                // Main Content
                React.createElement('main', { className: 'max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8' },
                    // Agents Tab
                    activeTab === 'agents' && React.createElement('div', { className: 'space-y-6' },
                        React.createElement('div', { className: 'bg-white rounded-lg shadow-sm border p-6' },
                            React.createElement('h3', { className: 'text-lg font-semibold mb-4 flex items-center' },
                                React.createElement(Plus, { className: 'w-5 h-5 mr-2' }),
                                'Add New Agent'
                            ),
                            React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-4' },
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Role'),
                                    React.createElement('input', {
                                        type: 'text',
                                        value: agentForm.role,
                                        onChange: (e) => setAgentForm({...agentForm, role: e.target.value}),
                                        className: 'w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500',
                                        placeholder: 'e.g., Research Analyst'
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Goal'),
                                    React.createElement('input', {
                                        type: 'text',
                                        value: agentForm.goal,
                                        onChange: (e) => setAgentForm({...agentForm, goal: e.target.value}),
                                        className: 'w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500',
                                        placeholder: 'What should this agent accomplish?'
                                    })
                                ),
                                React.createElement('div', { className: 'md:col-span-2' },
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Backstory'),
                                    React.createElement('textarea', {
                                        value: agentForm.backstory,
                                        onChange: (e) => setAgentForm({...agentForm, backstory: e.target.value}),
                                        className: 'w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500',
                                        rows: 3,
                                        placeholder: "Agent's background and expertise..."
                                    })
                                )
                            ),
                            React.createElement('button', {
                                onClick: addAgent,
                                className: 'mt-4 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors'
                            }, 'Add Agent')
                        ),
                        
                        React.createElement('div', { className: 'bg-white rounded-lg shadow-sm border' },
                            React.createElement('div', { className: 'p-6 border-b' },
                                React.createElement('h3', { className: 'text-lg font-semibold flex items-center' },
                                    React.createElement(Users, { className: 'w-5 h-5 mr-2' }),
                                    `Configured Agents (${agents.length})`
                                )
                            ),
                            React.createElement('div', { className: 'divide-y' },
                                agents.length === 0 ? 
                                    React.createElement('div', { className: 'p-6 text-center text-gray-500' },
                                        'No agents configured yet. Add your first agent above.'
                                    ) :
                                    agents.map(agent => 
                                        React.createElement('div', { key: agent.id, className: 'p-6' },
                                            React.createElement('div', { className: 'flex justify-between items-start' },
                                                React.createElement('div', { className: 'flex-1' },
                                                    React.createElement('h4', { className: 'font-medium text-gray-900' }, agent.role),
                                                    React.createElement('p', { className: 'text-sm text-gray-600 mt-1' }, agent.goal),
                                                    React.createElement('p', { className: 'text-xs text-gray-500 mt-2' }, agent.backstory)
                                                ),
                                                React.createElement('button', {
                                                    onClick: () => setAgents(agents.filter(a => a.id !== agent.id)),
                                                    className: 'text-red-600 hover:text-red-800'
                                                },
                                                    React.createElement(Trash2, { className: 'w-4 h-4' })
                                                )
                                            )
                                        )
                                    )
                            )
                        )
                    ),

                    // Tasks Tab
                    activeTab === 'tasks' && React.createElement('div', { className: 'space-y-6' },
                        React.createElement('div', { className: 'bg-white rounded-lg shadow-sm border p-6' },
                            React.createElement('h3', { className: 'text-lg font-semibold mb-4 flex items-center' },
                                React.createElement(Plus, { className: 'w-5 h-5 mr-2' }),
                                'Add New Task'
                            ),
                            React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-4' },
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Task Name'),
                                    React.createElement('input', {
                                        type: 'text',
                                        value: taskForm.name,
                                        onChange: (e) => setTaskForm({...taskForm, name: e.target.value}),
                                        className: 'w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500',
                                        placeholder: 'e.g., Market Research'
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Assigned Agent'),
                                    React.createElement('select', {
                                        value: taskForm.assignedAgent,
                                        onChange: (e) => setTaskForm({...taskForm, assignedAgent: e.target.value}),
                                        className: 'w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500'
                                    },
                                        React.createElement('option', { value: '' }, 'Select an agent...'),
                                        agents.map(agent => 
                                            React.createElement('option', { key: agent.id, value: agent.role }, agent.role)
                                        )
                                    )
                                ),
                                React.createElement('div', { className: 'md:col-span-2' },
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Description'),
                                    React.createElement('textarea', {
                                        value: taskForm.description,
                                        onChange: (e) => setTaskForm({...taskForm, description: e.target.value}),
                                        className: 'w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500',
                                        rows: 3,
                                        placeholder: 'Detailed task description...'
                                    })
                                ),
                                React.createElement('div', { className: 'md:col-span-2' },
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Expected Output'),
                                    React.createElement('textarea', {
                                        value: taskForm.expectedOutput,
                                        onChange: (e) => setTaskForm({...taskForm, expectedOutput: e.target.value}),
                                        className: 'w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500',
                                        rows: 2,
                                        placeholder: 'What should the output look like?'
                                    })
                                )
                            ),
                            React.createElement('button', {
                                onClick: addTask,
                                className: 'mt-4 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors'
                            }, 'Add Task')
                        ),

                        React.createElement('div', { className: 'bg-white rounded-lg shadow-sm border' },
                            React.createElement('div', { className: 'p-6 border-b' },
                                React.createElement('h3', { className: 'text-lg font-semibold flex items-center' },
                                    React.createElement(CheckSquare, { className: 'w-5 h-5 mr-2' }),
                                    `Configured Tasks (${tasks.length})`
                                )
                            ),
                            React.createElement('div', { className: 'divide-y' },
                                tasks.length === 0 ? 
                                    React.createElement('div', { className: 'p-6 text-center text-gray-500' },
                                        'No tasks configured yet. Add your first task above.'
                                    ) :
                                    tasks.map(task => 
                                        React.createElement('div', { key: task.id, className: 'p-6' },
                                            React.createElement('div', { className: 'flex justify-between items-start' },
                                                React.createElement('div', { className: 'flex-1' },
                                                    React.createElement('h4', { className: 'font-medium text-gray-900' }, task.name),
                                                    React.createElement('p', { className: 'text-sm text-gray-600 mt-1' }, task.description),
                                                    React.createElement('p', { className: 'text-xs text-gray-500 mt-2' }, `Expected: ${task.expectedOutput}`)
                                                ),
                                                React.createElement('button', {
                                                    onClick: () => setTasks(tasks.filter(t => t.id !== task.id)),
                                                    className: 'text-red-600 hover:text-red-800'
                                                },
                                                    React.createElement(Trash2, { className: 'w-4 h-4' })
                                                )
                                            )
                                        )
                                    )
                            )
                        )
                    ),

                    // Execute Tab
                    activeTab === 'execute' && React.createElement('div', { className: 'space-y-6' },
                        React.createElement('div', { className: 'bg-white rounded-lg shadow-sm border p-6' },
                            React.createElement('h3', { className: 'text-lg font-semibold mb-4 flex items-center' },
                                React.createElement(Settings, { className: 'w-5 h-5 mr-2' }),
                                'Execution Configuration'
                            ),
                            React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-4' },
                                React.createElement('div', { className: 'md:col-span-2' },
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Topic/Objective'),
                                    React.createElement('input', {
                                        type: 'text',
                                        value: executionConfig.topic,
                                        onChange: (e) => setExecutionConfig({...executionConfig, topic: e.target.value}),
                                        className: 'w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500',
                                        placeholder: 'What should the crew work on?'
                                    })
                                )
                            ),
                            
                            React.createElement('div', { className: 'mt-6 flex justify-between items-center' },
                                React.createElement('div', { className: 'text-sm text-gray-600' },
                                    `Ready: ${agents.length} agents, ${tasks.length} tasks`
                                ),
                                React.createElement('button', {
                                    onClick: executeCrewAPI,
                                    disabled: isExecuting || agents.length === 0 || tasks.length === 0 || !executionConfig.topic,
                                    className: 'bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center'
                                },
                                    isExecuting ? 
                                        React.createElement(React.Fragment, null,
                                            React.createElement('div', { className: 'animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2' }),
                                            'Executing...'
                                        ) :
                                        React.createElement(React.Fragment, null,
                                            React.createElement(Play, { className: 'w-4 h-4 mr-2' }),
                                            'Execute Crew'
                                        )
                                )
                            )
                        ),

                        React.createElement('div', { className: 'grid grid-cols-1 lg:grid-cols-2 gap-6' },
                            React.createElement('div', { className: 'bg-white rounded-lg shadow-sm border' },
                                React.createElement('div', { className: 'p-4 border-b' },
                                    React.createElement('h3', { className: 'font-semibold flex items-center' },
                                        React.createElement(MessageSquare, { className: 'w-4 h-4 mr-2' }),
                                        'Execution Logs'
                                    )
                                ),
                                React.createElement('div', { className: 'p-4 h-64 overflow-y-auto' },
                                    executionLogs.length === 0 ? 
                                        React.createElement('div', { className: 'text-gray-500 text-sm' },
                                            'No logs yet. Start an execution to see real-time updates.'
                                        ) :
                                        executionLogs.map((log, index) => 
                                            React.createElement('div', { 
                                                key: index, 
                                                className: `text-sm mb-2 ${
                                                    log.level === 'error' ? 'text-red-600' : 
                                                    log.level === 'success' ? 'text-green-600' : 
                                                    'text-gray-700'
                                                }`
                                            }, log.message)
                                        )
                                )
                            ),

                            React.createElement('div', { className: 'bg-white rounded-lg shadow-sm border' },
                                React.createElement('div', { className: 'p-4 border-b' },
                                    React.createElement('h3', { className: 'font-semibold flex items-center' },
                                        React.createElement(FileText, { className: 'w-4 h-4 mr-2' }),
                                        'Output'
                                    )
                                ),
                                React.createElement('div', { className: 'p-4 h-64 overflow-y-auto' },
                                    React.createElement('pre', { className: 'text-sm text-gray-700 whitespace-pre-wrap' },
                                        executionOutput || 'No output yet. Results will appear here during execution.'
                                    )
                                )
                            )
                        )
                    ),

                    // Files Tab
                    activeTab === 'files' && React.createElement('div', { className: 'space-y-6' },
                        React.createElement('div', { className: 'bg-white rounded-lg shadow-sm border' },
                            React.createElement('div', { className: 'p-6 border-b' },
                                React.createElement('h3', { className: 'text-lg font-semibold flex items-center' },
                                    React.createElement(FolderOpen, { className: 'w-5 h-5 mr-2' }),
                                    'Generated Files (0)'
                                )
                            ),
                            React.createElement('div', { className: 'p-6 text-center text-gray-500' },
                                'No files generated yet. Execute a crew to generate output files.'
                            )
                        )
                    )
                )
            );
        };

        ReactDOM.render(React.createElement(CrewAIDashboard), document.getElementById('root'));
    </script>
</body>
</html>